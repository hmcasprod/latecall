<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Late Call Entry Form</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js"></script>

  <script>
    // Firebase configuration (replace with your actual config from Firebase Console)
    const firebaseConfig = {
      apiKey: "AIzaSyC-RidAbJBCvoxT6aalA-lXA1u5ZT1PC4o",
      authDomain: "hmcas-latecall.firebaseapp.com",
      projectId: "hmcas-latecall",
      storageBucket: "hmcas-latecall.appspot.com",
      messagingSenderId: "498700648548",
      appId: "1:498700648548:web:393d1676210823f7f49f71"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>
</head>

<body>

  <!-- Late Call Entry Form -->
  <h1>Late Call Entry Form</h1>
  
  <form id="lateCallForm">
    <label for="date">Date *</label>
    <input type="date" id="date" required>

    <label for="name">Name *</label>
    <input type="text" id="name" required>

    <label for="corp">Corp Number *</label>
    <input type="text" id="corp" required>

    <label for="hub">HUB *</label>
    <select id="hub" required>
      <option value="">-- Select HUB --</option>
      <option>Hub 1</option>
      <option>Hub 2</option>
      <option>Hub 3</option>
      <option>Hub 4</option>
      <option>Hub 5</option>
      <option>Hub 6</option>
      <option>Hub 7</option>
      <option>Hub 8</option>
      <option>Events</option>
      <option>SAS</option>
      <option>Retrieval</option>
      <option>Life Flight</option>
      <option value="Others">Other/s : Please Specify</option>
    </select>

    <input type="text" id="otherHub" placeholder="Please specify" style="display:none;">

    <label for="unit">Unit *</label>
    <input type="text" id="unit" required>

    <label for="shift">Shift *</label>
    <select id="shift" required>
      <option value="">-- Select Shift --</option>
      <option>Day</option>
      <option>Peak</option>
      <option>Night</option>
      <option>Event</option>
    </select>

    <label for="timeout">Time Out *</label>
    <input type="time" id="timeout" required>

    <label for="trip">Trip Number / Reason for Late Time Out *</label>
    <input type="text" id="trip" required>

    <input type="submit" value="Submit">
  </form>

  <!-- Form Submission Script -->
  <script>
    document.getElementById('lateCallForm').addEventListener('submit', async (e) => {
      e.preventDefault(); // Prevent default form submission

      // Get form data
      const date = document.getElementById('date').value;
      const name = document.getElementById('name').value;
      const corp = document.getElementById('corp').value;
      const hub = document.getElementById('hub').value === "Others" 
        ? document.getElementById('otherHub').value
        : document.getElementById('hub').value;
      const unit = document.getElementById('unit').value;
      const shift = document.getElementById('shift').value;
      const timeout = document.getElementById('timeout').value;
      const trip = document.getElementById('trip').value;

      // Submit data to Firestore
      try {
        await db.collection('requests').add({
          date: date, 
          name: name,
          corp: corp,
          hub: hub,
          unit: unit,
          shift: shift,
          timeout: timeout,
          trip: trip,
          status: 'Pending',  // Default status
        });
        alert('Request submitted successfully!');
        document.getElementById('lateCallForm').reset();  // Reset form after submission
      } catch (error) {
        console.error("Error submitting data: ", error);
        alert('Failed to submit data.');
      }
    });
  </script>

</body>
</html>
